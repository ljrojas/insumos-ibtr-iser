{
    "type": [
        1,
        2,
        3,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        2
    ],
    "data": [
        "}",
        "Boton sin region\nClick region: region de arica y parinacota \narica \nclick buscar\nARICADirección: Juan Noé N° 933 \nHorario de atención: Lunes a jueves, de 08:30 a 14:30 hrs. Viernes, 08:30 a 14:00 hrs. \nMódulo ChileAtiende Express. Trámites que se pueden realizar \nVideointerpretación ¿Qué es? \nReserve su hora de atención aquí. ¿Trámites IPS que se pueden agendar? \nVer mapa \n",
        "Error in ll[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "ll",
        "list()\n",
        "> ",
        "c[[1]]$findChildElements(\"tag\",\"iframe\")[[1]]",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "      # click boton iframe",
        "> ",
        "      btn_gm[[b]]$clickElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "      href <- btn_gm[[b]]$getElementAttribute(\"href\")",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "      remDr$switchToFrame(NULL)",
        "> ",
        "      # click boton iframe",
        "> ",
        "      btn_gm[[b]]$clickElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "# visistar url busqueda",
        "> ",
        "remDr$navigate(url_isp)",
        "> ",
        "# 1. boton buscar",
        "> ",
        "buscar <- remDr$findElement('id','buscar')",
        "> ",
        "# 2. selector region y comuna",
        "> ",
        "selector <- remDr$findElements(\"tag\", \"select\")",
        "> ",
        "selector %>% length()",
        "[1] 2\n",
        "> ",
        "selector[[2]]$getElementText()",
        "[[1]]\n[1] \"     Seleccionar Comuna\\n    \"\n\n",
        "> ",
        "# asignar selectores region y comuna",
        "> ",
        "for (j in seq_len(length(selector))) {",
        "+ ",
        "  texto <-",
        "+ ",
        "    selector[[j]]$getElementText() %>%",
        "+ ",
        "    stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "    str_to_lower()",
        "+ ",
        "  # print(texto)",
        "+ ",
        "  if (str_detect(texto,'region')) {",
        "+ ",
        "    sel_region <- selector[[j]]",
        "+ ",
        "  }",
        "+ ",
        "  if (str_detect(texto,'comuna')) {",
        "+ ",
        "    sel_comuna <- selector[[j]]",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "# click selector region",
        "> ",
        "sel_region$clickElement()",
        "> ",
        "# rescatar opciones",
        "> ",
        "opt_region <- sel_region$findChildElements(\"tag\",\"option\")",
        "> ",
        "i<-2",
        "> ",
        "# for (i in seq_len(length(opt_region))) {",
        "> ",
        "  text_opt_reg <-",
        "+ ",
        "    opt_region[[i]]$getElementText()[[1]] %>%",
        "+ ",
        "    stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "    str_to_lower() %>%",
        "+ ",
        "    str_trim()",
        "> ",
        "  # descartar texto \"seleccione\"",
        "> ",
        "  if (str_detect(text_opt_reg,'seleccione')) {",
        "+ ",
        "    cat('Boton sin region\\n')",
        "+ ",
        "    next",
        "+ ",
        "  }",
        "> ",
        "  # click region",
        "> ",
        "  cat('Click region:', text_opt_reg, '\\n')",
        "Click region: region de arica y parinacota \n",
        "> ",
        "  opt_region[[i]]$clickElement()",
        "> ",
        "  # rescatar comunas",
        "> ",
        "  sel_comuna$clickElement()",
        "> ",
        "  opt_comunas <- sel_comuna$findChildElements('tag','option')",
        "> ",
        "j<-2",
        "> ",
        "    text_comuna <-",
        "+ ",
        "      opt_comunas[[j]]$getElementText()[[1]] %>%",
        "+ ",
        "      stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "      str_to_lower() %>%",
        "+ ",
        "      str_trim()",
        "> ",
        "    # saltarse texto instruccion",
        "> ",
        "    if (str_detect(text_comuna,'seleccionar comuna')) {",
        "+ ",
        "      next",
        "+ ",
        "    }",
        "> ",
        "    cat(text_comuna,'\\n')",
        "arica \n",
        "> ",
        "    # click comuna",
        "> ",
        "    opt_comunas[[j]]$clickElement()",
        "> ",
        "    # click buscar",
        "> ",
        "    cat('click buscar\\n')",
        "click buscar\n",
        "> ",
        "    buscar$clickElement()",
        "> ",
        "    c <- remDr$findElements(\"xpath\",\"//div[contains(@class,'panel-body')]\")",
        "> ",
        "    length(c)",
        "[1] 16\n",
        "> ",
        "    c[[1]]$highlightElement()",
        "> ",
        "    # titulo comuna",
        "> ",
        "    h4 <- c[[1]]$findChildElements(\"tag\",\"h4\")",
        "> ",
        "    h4[[2]]$getElementText()",
        "[[1]]\n[1] \"\"\n\n",
        "> ",
        "    h4[[1]]$getElementText()",
        "[[1]]\n[1] \"ARICA\"\n\n",
        "> ",
        "    for (h in seq_len(length(h4))) {",
        "+ ",
        "      text_h4 <- h4[[h]]$getElementText()[[1]] %>% str_trim()",
        "+ ",
        "      if (text_h4 == \"\" ) next",
        "+ ",
        "      cat(text_h4)",
        "+ ",
        "    }",
        "ARICA",
        "> ",
        "    # direccion",
        "> ",
        "    dir <- c[[1]]$findChildElements(\"class\",\"minirecuadro\")",
        "> ",
        "    length(dir)",
        "[1] 7\n",
        "> ",
        "    for (x in seq_len(length(dir))) {",
        "+ ",
        "      text_dir <- dir[[x]]$getElementText()[[1]] %>% str_trim()",
        "+ ",
        "      if (text_dir==\"\") next",
        "+ ",
        "      cat(text_dir,\"\\n\")",
        "+ ",
        "    }",
        "Dirección: Juan Noé N° 933 \nHorario de atención: Lunes a jueves, de 08:30 a 14:30 hrs. Viernes, 08:30 a 14:00 hrs. \nMódulo ChileAtiende Express. Trámites que se pueden realizar \nVideointerpretación ¿Qué es? \nReserve su hora de atención aquí. ¿Trámites IPS que se pueden agendar? \n",
        "> ",
        "    # boton mapa",
        "> ",
        "    btn_gm <- c[[1]]$findChildElements(\"class\",\"alternar-respuesta\")",
        "> ",
        "    length(btn_gm)",
        "[1] 2\n",
        "> ",
        "b<-1",
        "> ",
        "      text_btn <- btn_gm[[b]]$getElementText()[[1]] %>% str_trim()",
        "> ",
        "      if (text_btn==\"\") next",
        "> ",
        "      cat(text_btn,\"\\n\")",
        "Ver mapa \n",
        "> ",
        "b",
        "[1] 1\n",
        "> ",
        "      data_iframe <- remDr]$getElementAttribute(\"data-iframe\")",
        "Error: inesperado ']' in \"      data_iframe <- remDr]\"\n",
        "> ",
        "      data_iframe <- remDr$getElementAttribute(\"data-iframe\")",
        "Error in envRefInferField(x, what, getClass(class(x)), selfEnv) : \n  ‘getElementAttribute’ is not a valid field or method name for reference class “remoteDriver”\n",
        "> ",
        "      length(remDr$findElements(\"tag\",\"iframe\")",
        "+ ",
        "      ",
        "+ ",
        "      data_iframe <- btn_gm[[b]]$getElementAttribute(\"data-iframe\")",
        "Error: unexpected symbol in:\n\"      \n      data_iframe\"\n",
        "> ",
        "      ",
        "> ",
        "      ",
        "> ",
        "      data_iframe %>% str_extract(\"(?<=!2d)-+\\\\d+\\\\.+\\\\d+\")",
        "[1] \"-70.31309898565583\"\n",
        "> ",
        "      ",
        "> ",
        "      href <- btn_gm[[b]]$getElementAttribute(\"href\")",
        "> ",
        "      # click boton iframe",
        "> ",
        "      btn_gm[[b]]$clickElement()",
        "> ",
        "      # seleccionar iframe",
        "> ",
        "      ",
        "> ",
        "      iframe <- c[[1]]$findChildElements(\"tag\",\"iframe\")[[1]]",
        "> ",
        "      ",
        "> ",
        "      remDr$switchToFrame(iframe)",
        "> ",
        "      remDr$switchToFrame(NULL)",
        "> ",
        "      ",
        "> ",
        "      ",
        "> ",
        "      # alternativa: text \"Ampliar el Mapa\"",
        "> ",
        "      ll <- remDr$findElements(\"xpath\",\"//*[contains(@href,'?ll=')]\")",
        "> ",
        "      href <- ll[[1]]$getElementAttribute('href')",
        "Error in ll[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "      ",
        "> ",
        "      # volver a frame original",
        "> ",
        "      remDr$switchToFrame(NULL)",
        "> ",
        "      ",
        "> ",
        "      btn_gm1 <- c[[1]]$findChildElements(\"class\",\"alternar-respuesta\")",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "      ",
        "> ",
        "      # cerrar el mapa",
        "> ",
        "      # click boton iframe",
        "> ",
        "      btn_gm[[b]]$isElementEnabled()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "      ",
        "> ",
        "      btn_gm[[b]]$clickElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "    }",
        "Error: inesperado '}' in \"    }\"\n",
        "> ",
        "    ",
        "> ",
        "    ",
        "> ",
        "    ",
        "> ",
        "    # check \"ver mapa\"",
        "> ",
        "",
        "> ",
        "    btn_gm[[2]]$getElementText()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "    btn_gm[[2]]$getElementAttribute(\"data-iframe\")",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "    # horario de atencion",
        "> ",
        "    # TODO",
        "> ",
        "",
        "> ",
        "    # click mapa",
        "> ",
        "",
        "> ",
        "    # recuperar latlon",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "  }",
        "Error: inesperado '}' in \"  }\"\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "}",
        "Error: inesperado '}' in \"}\"\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "# descartar texto \"Seleccione Region\"",
        "> ",
        "",
        "> ",
        "opt_region[[2]]$getElementText()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "opt_region[[2]]$clickElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "opt_comunas <- sel_comuna$findChildElements(\"tag\",\"option\")",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "length(opt_comunas)",
        "[1] 3\n",
        "> ",
        "",
        "> ",
        "# descartar seleccionar comuna",
        "> ",
        "",
        "> ",
        "# seleccciona comuna",
        "> ",
        "opt_comunas[[2]]$getElementText()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "# seleccionar comuna",
        "> ",
        "comunas[[3]]$clickElement()",
        "Error: objeto 'comunas' no encontrado\n",
        "> ",
        "",
        "> ",
        "# 2. click boton buscar",
        "> ",
        "buscar$clickElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "# rescatar elementos resultantes",
        "> ",
        "elementos <- remDr$findElements(\"class name\", \"accordion-toggle\")",
        "> ",
        "",
        "> ",
        "# CHECK TEXTO #region",
        "> ",
        "elementos[[1]]$getElementText()[[1]]",
        "Error in elementos[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "# si contiene rescatar link",
        "> ",
        "elementos[[1]]$getElementAttribute('href')[[1]]",
        "Error in elementos[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "",
        "> ",
        "# clickear elemento",
        "> ",
        "elementos[[5]]$clickElement()",
        "Error in elementos[[5]] : subíndice fuera de  los límites\n",
        "> ",
        "",
        "> ",
        "# numero paginas",
        "> ",
        "paginas <- remDr$findElements(\"class name\", \"page page-\")",
        "\nSelenium message:Compound class names not permitted\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/invalid_selector_exception.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: InvalidSelector\n \t Detail: Argument was an invalid selector (e.g. XPath/CSS).\n\t Further Details: run errorDetails method\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "# 1. Rescatar zonas censales y links",
        "> ",
        "",
        "> ",
        "# Iniciar acumulador",
        "> ",
        "zonas <- data.frame(region = character(), url = character())",
        "> ",
        "# loop guardar link y nombre region",
        "> ",
        "for (i in seq_len(length(elementos))) {",
        "+ ",
        "  # si nombre contiene zona censal",
        "+ ",
        "  if (elementos[[i]]$getElementText()[[1]] %>% str_detect('Zona Censal')) {",
        "+ ",
        "    # rescata nombre region (text) y link (href)",
        "+ ",
        "    zonas[i,] <- c(elementos[[i]]$getElementText()[[1]],",
        "+ ",
        "                   elementos[[i]]$getElementAttribute('href')[[1]])",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "# 2. Recuperar link descarga archivo",
        "> ",
        "",
        "> ",
        "# Estrategia:",
        "> ",
        "# Abrir cada pagina y buscar boton descarga",
        "> ",
        "# Luego rescatar vinculo a Shapefile",
        "> ",
        "",
        "> ",
        "# iniciar acumulador",
        "> ",
        "links_descarga <- data.frame(region = character(), link = character())",
        "> ",
        "# loop entrar link y recuperar link descarga archivo",
        "> ",
        "for (i in seq_len(nrow(zonas))) {",
        "+ ",
        "  # parametros",
        "+ ",
        "  region <- zonas$region[i]",
        "+ ",
        "  url_reg <- zonas$url[i]",
        "+ ",
        "  # visitar pagina",
        "+ ",
        "  remDr$navigate(url_reg)",
        "+ ",
        "  # Sys.sleep",
        "+ ",
        "",
        "+ ",
        "  # buscar boton download",
        "+ ",
        "  btn <- remDr$findElement('css selector','.hub-download')",
        "+ ",
        "  btn$clickElement() # opciones de descarga aparecen",
        "+ ",
        "",
        "+ ",
        "  # buscar shp",
        "+ ",
        "  el1 <- remDr$findElements('class name', 'download-item')",
        "+ ",
        "",
        "+ ",
        "  # acumulador",
        "+ ",
        "  link_descarga <- data.frame(text = character(), id = character(), href = character())",
        "+ ",
        "  # loop construir alternativas de descarga",
        "+ ",
        "  for (j in seq_len(length(el1))) {",
        "+ ",
        "    # print(el1[[i]]$getElementText())",
        "+ ",
        "    # print(el1[[i]]$getElementAttribute('id'))",
        "+ ",
        "    # print(el1[[i]]$getElementAttribute('href'))",
        "+ ",
        "    link_descarga[j,] <- c(",
        "+ ",
        "      el1[[j]]$getElementText()[[1]],",
        "+ ",
        "      el1[[j]]$getElementAttribute('id')[[1]],",
        "+ ",
        "      el1[[j]]$getElementAttribute('href')[[1]]",
        "+ ",
        "    )",
        "+ ",
        "  }",
        "+ ",
        "",
        "+ ",
        "  # limpiar",
        "+ ",
        "  link_descarga <-",
        "+ ",
        "    link_descarga %>%",
        "+ ",
        "    mutate(",
        "+ ",
        "      text = str_to_lower(text), # minusculas",
        "+ ",
        "      id = str_extract(id,'\\\\d+') %>% as.numeric(), # rescata num id",
        "+ ",
        "      href = str_extract(href,'.*\\\\w{3}(?=\\\\?)') # descarta parametros url",
        "+ ",
        "    )",
        "+ ",
        "",
        "+ ",
        "  # filtrar menor id y guardar en acumulador general (linkS_descarga)",
        "+ ",
        "  links_descarga[i,] <-",
        "+ ",
        "    c(",
        "+ ",
        "      region,",
        "+ ",
        "      link_descarga %>%",
        "+ ",
        "        filter(",
        "+ ",
        "          str_detect(text,'shape')",
        "+ ",
        "        ) %>%",
        "+ ",
        "        filter(",
        "+ ",
        "          id == min(id) # primer elemento que aparece; el segundo es subset",
        "+ ",
        "        ) %>%",
        "+ ",
        "        pull(href)",
        "+ ",
        "    )",
        "+ ",
        "",
        "+ ",
        "",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "# consolidar resultados",
        "> ",
        "zonas <-",
        "+ ",
        "  zonas %>%",
        "+ ",
        "  left_join(links_descarga)",
        "Error in left_join(., links_descarga) : \n  no se pudo encontrar la función \"left_join\"\n",
        "> ",
        "",
        "> ",
        "# guardar resultados",
        "> ",
        "write_csv(zonas, 'data/links-download-zonas.csv')",
        "> ",
        "",
        "> ",
        "# localidades rurales -----------------------------------------------------",
        "> ",
        "",
        "> ",
        "# insepeccion de resultados muestra que link de pagina de elemento a descargar",
        "> ",
        "# contiene informacion para construir link de descarga de información",
        "> ",
        "",
        "> ",
        "# visistar pagina resultados de busqueda",
        "> ",
        "remDr$navigate(url_loc)",
        "Error in queryRD(qpath, \"POST\", qdata = list(url = url)) : \n  objeto 'url_loc' no encontrado\n",
        "> ",
        "",
        "> ",
        "# rescatar resultados",
        "> ",
        "elementos <- remDr$findElements(\"class name\", \"result-name\")",
        "> ",
        "",
        "> ",
        "# chequear si nombre contiene region y zona censal",
        "> ",
        "elementos[[1]]$getElementText()[[1]] %>% str_detect('Localidad Rural')",
        "Error in elementos[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "# si contiene rescatar link",
        "> ",
        "elementos[[1]]$getElementAttribute('href')[[1]]",
        "Error in elementos[[1]] : subíndice fuera de  los límites\n",
        "> ",
        "",
        "> ",
        "# guardar link y nombre region",
        "> ",
        "localidades <- data.frame(region=character(),url=character())",
        "> ",
        "for (i in seq_len(length(elementos))) {",
        "+ ",
        "  if (elementos[[i]]$getElementText()[[1]] %>% str_detect('Localidad Rural')) {",
        "+ ",
        "    localidades[i,] <- c(elementos[[i]]$getElementText()[[1]],",
        "+ ",
        "                         elementos[[i]]$getElementAttribute('href')[[1]])",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "# construye link de descarga a partir de direccion resultados",
        "> ",
        "localidades <-",
        "+ ",
        "  localidades %>%",
        "+ ",
        "  mutate(href = str_replace(url,'geo-ine-chile.','') %>% paste0(.,'.zip'))",
        "Error in mutate(., href = str_replace(url, \"geo-ine-chile.\", \"\") %>% paste0(.,  : \n  no se pudo encontrar la función \"mutate\"\n",
        "> ",
        "",
        "> ",
        "# guardar resultados",
        "> ",
        "localidades %>%",
        "+ ",
        "  write_csv('data/links-downloads-localidades.csv')",
        "> ",
        "",
        "> ",
        "# cerrar selenium",
        "> ",
        "remDr$close()",
        "> ",
        "> ",
        "> ",
        "> ",
        "> ",
        "      length(remDr$findElements(\"tag\",\"iframe\"))",
        "\nSelenium message:No active session with ID 4805e5e7ab47c80ddaf681ed6d52b1cc\n\n",
        "Error: \t Summary: NoSuchDriver\n \t Detail: A session is either terminated or not started\n\t Further Details: run errorDetails method\n",
        "> ",
        "# library(rvest)",
        "> ",
        "library(RSelenium) # requiere chrome y java",
        "> ",
        "library(stringr)",
        "> ",
        "library(stringi)",
        "> ",
        "library(readr)",
        "> ",
        "library(purrr)",
        "> ",
        "# url de busqueda zona censal y localidad rural",
        "> ",
        "url_isp <- \"https://www.ips.gob.cl/servlet/internet/inicio/red-de-atencion/sucursales\"",
        "> ",
        "# debiese abrir un navegador chro,e",
        "> ",
        "rD <- rsDriver()",
        "checking Selenium Server versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking chromedriver versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking geckodriver versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking phantomjs versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "[1] \"Connecting to remote server\"\n$acceptInsecureCerts\n[1] FALSE\n\n$browserName\n[1] \"chrome\"\n\n$browserVersion\n[1] \"89.0.4389.82\"\n\n$chrome\n$chrome$chromedriverVersion\n[1] \"89.0.4389.23 (61b08ee2c50024bab004e48d2b1b083cdbdac579-refs/branch-heads/4389@{#294})\"\n\n$chrome$userDataDir\n[1] \"C:\\\\Users\\\\56964\\\\AppData\\\\Local\\\\Temp\\\\scoped_dir420_252201560\"\n\n\n$`goog:chromeOptions`\n$`goog:chromeOptions`$debuggerAddress\n[1] \"localhost:59087\"\n\n\n$networkConnectionEnabled\n[1] FALSE\n\n$pageLoadStrategy\n[1] \"normal\"\n\n$platformName\n",
        "[1] \"windows\"\n\n$proxy\nnamed list()\n\n$setWindowRect\n[1] TRUE\n\n$strictFileInteractability\n[1] FALSE\n\n$timeouts\n$timeouts$implicit\n[1] 0\n\n$timeouts$pageLoad\n[1] 300000\n\n$timeouts$script\n[1] 30000\n\n\n$unhandledPromptBehavior\n[1] \"dismiss and notify\"\n\n$`webauthn:extension:largeBlob`\n[1] TRUE\n\n$`webauthn:virtualAuthenticators`\n[1] TRUE\n\n$webdriver.remote.sessionid\n[1] \"55813bda43cfc859551dc81739ce8163\"\n\n$id\n[1] \"55813bda43cfc859551dc81739ce8163\"\n\n",
        "> ",
        "remDr <- rD[[\"client\"]]",
        "> ",
        "# debiese abrir un navegador chro,e",
        "> ",
        "rD <- rsDriver()",
        "checking Selenium Server versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking chromedriver versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking geckodriver versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "checking phantomjs versions:\n",
        "BEGIN: PREDOWNLOAD\n",
        "BEGIN: DOWNLOAD\n",
        "BEGIN: POSTDOWNLOAD\n",
        "Error in wdman::selenium(port = port, verbose = verbose, version = version,  : \n  Selenium server signals port = 4567 is already in use.\n",
        "> ",
        "remDr <- rD[[\"client\"]]",
        "> ",
        "# visistar url busqueda",
        "> ",
        "remDr$navigate(url_isp)",
        "> ",
        "# 1. boton buscar",
        "> ",
        "buscar <- remDr$findElement('id','buscar')",
        "> ",
        "# 2. selector region y comuna",
        "> ",
        "selector <- remDr$findElements(\"tag\", \"select\")",
        "> ",
        "selector %>% length()",
        "[1] 2\n",
        "> ",
        "selector[[2]]$getElementText()",
        "[[1]]\n[1] \"     Seleccionar Comuna\\n    \"\n\n",
        "> ",
        "# asignar selectores region y comuna",
        "> ",
        "for (j in seq_len(length(selector))) {",
        "+ ",
        "  texto <-",
        "+ ",
        "    selector[[j]]$getElementText() %>%",
        "+ ",
        "    stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "    str_to_lower()",
        "+ ",
        "  # print(texto)",
        "+ ",
        "  if (str_detect(texto,'region')) {",
        "+ ",
        "    sel_region <- selector[[j]]",
        "+ ",
        "  }",
        "+ ",
        "  if (str_detect(texto,'comuna')) {",
        "+ ",
        "    sel_comuna <- selector[[j]]",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "# click selector region",
        "> ",
        "sel_region$clickElement()",
        "> ",
        "# rescatar opciones",
        "> ",
        "opt_region <- sel_region$findChildElements(\"tag\",\"option\")",
        "> ",
        "i<-2",
        "> ",
        "# for (i in seq_len(length(opt_region))) {",
        "> ",
        "  text_opt_reg <-",
        "+ ",
        "    opt_region[[i]]$getElementText()[[1]] %>%",
        "+ ",
        "    stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "    str_to_lower() %>%",
        "+ ",
        "    str_trim()",
        "> ",
        "  # descartar texto \"seleccione\"",
        "> ",
        "  if (str_detect(text_opt_reg,'seleccione')) {",
        "+ ",
        "    cat('Boton sin region\\n')",
        "+ ",
        "    next",
        "+ ",
        "  }",
        "> ",
        "  # click region",
        "> ",
        "  cat('Click region:', text_opt_reg, '\\n')",
        "Click region: region de arica y parinacota \n",
        "> ",
        "  opt_region[[i]]$clickElement()",
        "> ",
        "  # rescatar comunas",
        "> ",
        "  sel_comuna$clickElement()",
        "> ",
        "  opt_comunas <- sel_comuna$findChildElements('tag','option')",
        "> ",
        "  j<-2",
        "> ",
        "    text_comuna <-",
        "+ ",
        "      opt_comunas[[j]]$getElementText()[[1]] %>%",
        "+ ",
        "      stri_trans_general(\"Latin-ASCII\") %>%",
        "+ ",
        "      str_to_lower() %>%",
        "+ ",
        "      str_trim()",
        "> ",
        "    # saltarse texto instruccion",
        "> ",
        "    if (str_detect(text_comuna,'seleccionar comuna')) {",
        "+ ",
        "      next",
        "+ ",
        "    }",
        "> ",
        "    cat(text_comuna,'\\n')",
        "arica \n",
        "> ",
        "    # click comuna",
        "> ",
        "    opt_comunas[[j]]$clickElement()",
        "> ",
        "    # click buscar",
        "> ",
        "    cat('click buscar\\n')",
        "click buscar\n",
        "> ",
        "    buscar$clickElement()",
        "> ",
        "    c <- remDr$findElements(\"xpath\",\"//div[contains(@class,'panel-body')]\")",
        "> ",
        "    length(c)",
        "[1] 16\n",
        "> ",
        "    c[[1]]$highlightElement()",
        "> ",
        "    # titulo comuna",
        "> ",
        "    h4 <- c[[1]]$findChildElements(\"tag\",\"h4\")",
        "> ",
        "    h4[[1]]$getElementText()",
        "[[1]]\n[1] \"ARICA\"\n\n",
        "> ",
        "    for (h in seq_len(length(h4))) {",
        "+ ",
        "      text_h4 <- h4[[h]]$getElementText()[[1]] %>% str_trim()",
        "+ ",
        "      if (text_h4 == \"\" ) next",
        "+ ",
        "      cat(text_h4)",
        "+ ",
        "    }",
        "ARICA",
        "> ",
        "    # direccion",
        "> ",
        "    dir <- c[[1]]$findChildElements(\"class\",\"minirecuadro\")",
        "> ",
        "    length(dir)",
        "[1] 7\n",
        "> ",
        "    for (x in seq_len(length(dir))) {",
        "+ ",
        "      text_dir <- dir[[x]]$getElementText()[[1]] %>% str_trim()",
        "+ ",
        "      if (text_dir==\"\") next",
        "+ ",
        "      cat(text_dir,\"\\n\")",
        "+ ",
        "    }",
        "Dirección: Juan Noé N° 933 \nHorario de atención: Lunes a jueves, de 08:30 a 14:30 hrs. Viernes, 08:30 a 14:00 hrs. \nMódulo ChileAtiende Express. Trámites que se pueden realizar \nVideointerpretación ¿Qué es? \nReserve su hora de atención aquí. ¿Trámites IPS que se pueden agendar? \n",
        "> ",
        "    # boton mapa",
        "> ",
        "    btn_gm <- c[[1]]$findChildElements(\"class\",\"alternar-respuesta\")",
        "> ",
        "    length(btn_gm)",
        "[1] 2\n",
        "> ",
        "    b<-1",
        "> ",
        "      btn_gm[[1]]$highlightElement()",
        "> ",
        "      text_btn <- btn_gm[[b]]$getElementText()[[1]] %>% str_trim()",
        "> ",
        "      if (text_btn==\"\") next",
        "> ",
        "      cat(text_btn,\"\\n\")",
        "Ver mapa \n",
        "> ",
        "      data_iframe <- btn_gm[[b]]$getElementAttribute(\"data-iframe\")",
        "> ",
        "      length(remDr$findElements(\"tag\",\"iframe\"))",
        "[1] 0\n",
        "> ",
        "      length(remDr$findElements(\"tag\",\"iframe\"))",
        "[1] 0\n",
        "> ",
        "      length(data_iframe)",
        "[1] 1\n",
        "> ",
        "      data_iframe %>% str_extract(\"(?<=!2d)-+\\\\d+\\\\.+\\\\d+\")",
        "[1] \"-70.31309898565583\"\n",
        "> ",
        "      href <- btn_gm[[b]]$getElementAttribute(\"href\")",
        "> ",
        "      # click boton iframe",
        "> ",
        "      btn_gm[[b]]$clickElement()",
        "> ",
        "      iframe <- c[[1]]$findChildElements(\"tag\",\"iframe\")[[1]]",
        "> ",
        "iframe",
        "[1] \"remoteDriver fields\"\n$remoteServerAddr\n[1] \"localhost\"\n\n$port\n[1] 4567\n\n$browserName\n[1] \"chrome\"\n\n$version\n[1] \"\"\n\n$platform\n[1] \"ANY\"\n\n$javascript\n[1] TRUE\n\n$nativeEvents\n[1] TRUE\n\n$extraCapabilities\nlist()\n\n[1] \"webElement fields\"\n$elementId\n[1] \"3d59c33f-124a-4d1d-b5c2-4c60efa5312d\"\n\n",
        "> ",
        "remDr",
        "$remoteServerAddr\n[1] \"localhost\"\n\n$port\n[1] 4567\n\n$browserName\n[1] \"chrome\"\n\n$version\n[1] \"\"\n\n$platform\n[1] \"ANY\"\n\n$javascript\n[1] TRUE\n\n$nativeEvents\n[1] TRUE\n\n$extraCapabilities\nlist()\n\n",
        "> ",
        "      remDr$switchToFrame(iframe)",
        "> ",
        "      # alternativa: text \"Ampliar el Mapa\"",
        "> ",
        "      ll <- remDr$findElements(\"xpath\",\"//*[contains(@href,'?ll=')]\")",
        "> ",
        "ll",
        "[[1]]\n[1] \"remoteDriver fields\"\n$remoteServerAddr\n[1] \"localhost\"\n\n$port\n[1] 4567\n\n$browserName\n[1] \"chrome\"\n\n$version\n[1] \"\"\n\n$platform\n[1] \"ANY\"\n\n$javascript\n[1] TRUE\n\n$nativeEvents\n[1] TRUE\n\n$extraCapabilities\nlist()\n\n[1] \"webElement fields\"\n$elementId\n[1] \"ec583edf-cc54-4673-8e8d-1e74726c7934\"\n\n\n",
        "> ",
        "      href <- ll[[1]]$getElementAttribute('href')",
        "> ",
        "href",
        "[[1]]\n[1] \"https://maps.google.com/maps?ll=-18.479474,-70.310534&z=16&t=m&hl=es-419&gl=CL&mapclient=embed&q=Dr.%20Juan%20Noe%20933%20Arica%20Arica%20y%20Parinacota\"\n\n",
        "> ",
        "      # volver a frame original",
        "> ",
        "      remDr$switchToFrame(NULL)",
        "> ",
        "      btn_gm[[1]]$highlightElement()",
        "\nSelenium message:stale element reference: element is not attached to the page document\n  (Session info: chrome=89.0.4389.82)\nFor documentation on this error, please visit: https://www.seleniumhq.org/exceptions/stale_element_reference.html\nBuild info: version: '4.0.0-alpha-2', revision: 'f148142cf8', time: '2019-07-01T21:30:10'\nSystem info: host: 'LAPTOP-NG35NH82', ip: '10.20.1.57', os.name: 'Windows 10', os.arch: 'amd64', os.version: '10.0', java.version: '1.8.0_251'\nDriver info: driver.version: unknown\n\n",
        "Error: \t Summary: StaleElementReference\n \t Detail: An element command failed because the referenced element is no longer attached to the DOM.\n \t class: org.openqa.selenium.StaleElementReferenceException\n\t Further Details: run errorDetails method\n",
        "\nRestarting R session...\n\n"
    ]
}